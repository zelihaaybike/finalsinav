# -------------------------------------------------------------------------- ###
# Soru 1a ---- https://github.com/zelihaaybike/finalsinav
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2a ----
library(dplyr)

ortalama_odeme <- titanic %>%
  group_by(sex) %>%
  summarize(ortalama_fare = mean(fare))

ortalama_odeme
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2b ----
library(tidyverse)

titanic %>%
  filter(!is.na(age)) %>%
  ggplot(aes(x = sex, y = age)) +
  geom_boxplot() +
  labs(x = "Cinsiyet", y = "Yaş") +
  ggtitle("Cinsiyete Göre Yaş Dağılımı")
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 2c ----
library(ggplot2)

ggplot(titanic, aes(x = survived, fill = sex)) +
  geom_bar() +
  labs(x = "Kurtulan", y = "Frekans") +
  ggtitle("Kurtulanların Cinsiyete Göre Dağılımı") +
  scale_fill_manual(values = c("female" = "pink", "male" = "lightblue"))
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3a ----
10 ve 13
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3b ----
library(dplyr)
dat3 <- inner_join(dat1, dat2)
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3c ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3d ----
2 ve 4 olarak değer alır.
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3e ----
P(Z ≤ 1) hesaplama
p_value <- pnorm(1, mean = 0, sd = 1)

Sonuç
p_value

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3f ----
tavla_zar_atısı <- function(n) {
zar1 <- sample(1:6, n, replace = TRUE)
zar2 <- sample(1:6, n, replace = TRUE)

for (i in 1:n) {cat("Zar 1:", zar1[i], "\tZar 2:", zar2[i], "\n")}
}

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 3g ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 4a ----
library(tidyr)

dat <- data.frame(
  country = c("_Ingiltere", "Almanya"),
  `2018` = c(8000, 10000),
  `2019` = c(8100, 11000),
  `2020` = c(8500, 10200)
)

dat2 <- pivot_longer(
  data = dat,
  cols = -country,
  names_to = "year",
  values_to = "gdp"
)

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Soru 5a ----
# -------------------------------------------------------------------------- ###